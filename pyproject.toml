[build-system]
requires = ["setuptools"]
build-backend = "setuptools.build_meta"

[project]
name = "voicetype"
authors = [{ name = "Adam Lewis" }]
requires-python = "<=3.12"
dependencies = [
    # "pyaudio",  # was causing me problems with audio
    "pynput @ git+https://github.com/Adam-D-Lewis/pynput@26fe001ada956c0ad023ea0e3aa3c7dded3526ad",
    "speechrecognition",
    "loguru",
    "pystray",
    "prompt_toolkit",
    "dasbus", # wayland
    # "pygame",  # for sound
    # "playsound3", # for sound
    "soundfile",  # for sound
    "sounddevice",  # for sound
    "pydub",  # for sound
    "pydantic-settings",
    "toml",
    "aider-chat", # for litellm
]
dynamic = ["version"]

[project.scripts]
voicetype = "voicetype.install:main"
run-voicetype = "voicetype.__main__:main"

[project.optional-dependencies]
dev = [
    "pytest",
    "pre-commit",
]
local = [
    "faster-whisper",
    # system deps on conda-forge
    # "libcublas",
    # "cudnn",

]
[tool.setuptools.packages.find]
include = ["voicetype*"]

[tool.setuptools.package-data]
"*" = ["*.wav"]
# "*" = ["*.css", "*.png"]

[tool.ruff]
select = ["ALL"]
# Ignore line too long, because due to black the error can only occur for strings
ignore = ["E501"]
fix = true

[tool.ruff.lint]
select = ["I"]

[tool.pixi.project]
channels = ["conda-forge"]
platforms = ["linux-64"]

[tool.pixi.dependencies]
# conda-forge dependencies
python = "<=3.12"

# Define the 'local' feature
[tool.pixi.feature.local]
channels = ["conda-forge"]

# PyPI packages for this feature
[tool.pixi.feature.local.pypi-dependencies]
voicetype = { path = ".", editable = true }

# Conda packages common across all platforms
[tool.pixi.feature.local.dependencies]

# Platform-scoped dependencies
[tool.pixi.feature.local.target.linux-64.dependencies]
libcublas = "*"
cudnn = "*"
gtk3 = "*"
gobject-introspection = "*"
pygobject = "*"


# Map environments to feature sets
[tool.pixi.environments]

[tool.pixi.environments.local]
features = ["local"]
